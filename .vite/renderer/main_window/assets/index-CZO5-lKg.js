(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))d(t);new MutationObserver(t=>{for(const c of t)if(c.type==="childList")for(const l of c.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&d(l)}).observe(document,{childList:!0,subtree:!0});function i(t){const c={};return t.integrity&&(c.integrity=t.integrity),t.referrerPolicy&&(c.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?c.credentials="include":t.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function d(t){if(t.ep)return;t.ep=!0;const c=i(t);fetch(t.href,c)}})();const a=document.querySelector(".fields"),m=MathQuill.getInterface(2);let u=0;const r=[m.MathField(document.querySelector(".field div"))],f=()=>{const e=document.createElement("div");e.className="field";const o=m.MathField(e);a.appendChild(e),r.push(o),o.focus()};f();const n={copyLatex:document.querySelector(".a-copy-latex"),copyImage:document.querySelector(".a-copy-image"),saveImage:document.querySelector(".a-save-image")};let s=!1;document.addEventListener("keydown",e=>{if(e.key==="Escape")r[u].focus();else if(e.key=="Enter")f();else if(e.key=="Delete"){if(r.length===1)return;const o=document.activeElement.parentElement.parentElement;if(!o)return;const i=Array.from(a.children).indexOf(o);a.removeChild(o),r.splice(i,1)}else e.key=="Control"?(s=!0,n.copyLatex.textContent="copy latex (L)",n.copyImage.textContent="copy image (I)",n.saveImage.textContent="save image (S)"):s&&(e.key=="l"&&n.copyLatex.click(),e.key=="i"&&n.copyImage.click(),e.key=="s"&&n.saveImage.click())});document.addEventListener("keyup",e=>{e.key=="Control"&&(s=!1,n.copyLatex.textContent="copy latex",n.copyImage.textContent="copy image",n.saveImage.textContent="save image")});n.copyLatex.addEventListener("click",()=>{navigator.clipboard.writeText(r[u].latex())});n.copyImage.addEventListener("click",()=>{html2canvas(a).then(e=>{e.toBlob(o=>{navigator.clipboard.write([new ClipboardItem({"image/png":o})])})})});n.saveImage.addEventListener("click",async()=>{html2canvas(a).then(e=>{const o=e.toDataURL("image/png"),i=document.createElement("a");i.href=o,i.download="equation.png",i.click()})});
